framework:
  id: "cis-kubernetes"
  name: "CIS Kubernetes Benchmarks"
  version: "1.8.0"
  url: "https://www.cisecurity.org/benchmark/kubernetes"

requirements:
  - id: "5.1.3"
    title: "Minimize Container Privileges"
    description: "Containers should run with the least privileges possible to minimize the impact of a compromise."
    rationale: "Privileged containers have access to all devices on the host, allowing malicious actors to break out of the container."
    controls:
      - "Do not run containers with 'privileged: true'"
      - "Do not run containers as root (RunAsUser: >0)"
    references:
      - "https://workbench.cisecurity.org/benchmarks/10650"

  - id: "5.2.2"
    title: "Minimize Host System Access"
    description: "Containers should not share the host's process ID (PID) namespace."
    rationale: "Sharing the PID namespace allows processes in the container to see and interact with processes on the host."
    controls:
      - "Set 'hostPID: false' in Pod Security Context"
    references:
      - "https://workbench.cisecurity.org/benchmarks/10650"

  - id: "5.4.1"
    title: "Prefer using secrets as files over environment variables"
    description: "Kubernetes Secrets should be mounted as volumes rather than exposed as environment variables."
    rationale: "Environment variables can be easily read by any process in the container and are often leaked in logs."
    controls:
      - "Mount secrets as read-only volumes"
      - "Avoid using 'envFrom' with Secrets"
    references:
      - "https://workbench.cisecurity.org/benchmarks/10650"

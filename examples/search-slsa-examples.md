# Searching for SLSA Policy Examples

This tutorial shows how to use the `search_policy_examples` tool to find SLSA (Supply-chain Levels for Software Artifacts) provenance verification policies.

## What is SLSA?

SLSA is a security framework for ensuring the integrity of software artifacts throughout the supply chain. SLSA policies in OPA verify that software was built securely, from trusted sources, using trusted build systems.

## Basic SLSA Search

Ask your AI assistant to search for SLSA policies:

```
Search for SLSA provenance verification policies
```

The `search_policy_examples` tool will be invoked with:

```json
{
  "query": "SLSA provenance verification policies"
}
```

### Expected Results

```json
{
  "results": [
    {
      "repo": "liatrio-autogov",
      "path": "policies/slsa/verify-provenance.rego",
      "snippet": "package slsa.verify\n\ndefault allow = false\n\nallow {\n  provenance := input.attestation.predicate\n  provenance.buildType == \"https://slsa.dev/provenance/v1\"\n  provenance.builder.id in trusted_builders\n}",
      "description": "Verify SLSA provenance attestations for build integrity",
      "tags": ["slsa", "provenance", "supply-chain", "attestation"],
      "similarityScore": 0.91
    }
  ],
  "totalFound": 1
}
```

## SLSA Level Queries

### SLSA Level 1 (Provenance Exists)

```
Find policies that verify SLSA Level 1 provenance exists
```

### SLSA Level 2 (Signed Provenance)

```
Search for policies verifying signed SLSA provenance from hosted build service
```

### SLSA Level 3 (Hardened Builds)

```
Find SLSA Level 3 policies that verify non-forgeable provenance
```

## Liatrio AutoGov Examples

The Liatrio AutoGov repository contains production-ready SLSA policies. Filter to this repo for battle-tested examples:

```json
{
  "query": "SLSA provenance build verification",
  "filterRepo": "liatrio-autogov"
}
```

### Common AutoGov Patterns

**Verify Builder Identity:**
```
Search for policies that verify SLSA builder identity from GitHub Actions
```

**Check Source Repository:**
```
Find SLSA policies that verify source repository matches expected origin
```

**Validate Build Steps:**
```
Search for policies verifying SLSA build configuration and steps
```

## More Specific Queries

### GitHub Actions Provenance

```
Find OPA policies for verifying GitHub Actions SLSA provenance
```

### Container Image Provenance

```
Search for SLSA policies for container image build provenance
```

### In-Toto Attestations

```
Find policies that verify in-toto attestation format for SLSA
```

### Trusted Builder Verification

```
Search for SLSA policies that check builder ID against trusted builders list
```

## Query Tips

1. **Mention "SLSA"** explicitly for supply chain policies
2. **Specify the level** (L1, L2, L3) for targeted results
3. **Include "provenance"** for build verification policies
4. **Add "attestation"** for signed metadata verification
5. **Use filterRepo: "liatrio-autogov"** for production examples

## Example Conversation

**You:** I need to implement SLSA provenance verification for our CI/CD pipeline. We use GitHub Actions.

**AI Assistant:** Let me search for relevant SLSA policies for GitHub Actions...

*[Uses search_policy_examples with query: "SLSA provenance GitHub Actions verification"]*

**AI Assistant:** I found several examples. This policy from liatrio-autogov verifies that the provenance attestation was generated by GitHub's trusted builder...

**You:** What about verifying the source repository?

**AI Assistant:** Good question - let me find policies that check source integrity...

*[Uses search_policy_examples with query: "SLSA verify source repository origin"]*

## Related Topics

- [Sigstore Examples](search-sigstore-examples.md) - Container signature verification (often used with SLSA)
- [RBAC Examples](search-rbac-examples.md) - Access control patterns
